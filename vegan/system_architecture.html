<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¹„ê±´ ë¼ì´í”„ íë ˆì´í„° - ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (Mermaid)</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .diagram-container {
            background: #f7fafc;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            overflow-x: auto;
        }

        .mermaid {
            display: flex;
            justify-content: center;
        }

        .info-section {
            margin-top: 40px;
            padding: 30px;
            background: #edf2f7;
            border-radius: 15px;
        }

        .info-title {
            font-size: 1.5em;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
            text-align: center;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .info-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .card-title {
            font-weight: 700;
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .card-content {
            color: #718096;
            line-height: 1.8;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-box {
            width: 30px;
            height: 20px;
            border-radius: 5px;
            border: 2px solid #333;
        }

        .legend-text {
            font-size: 0.9em;
            color: #4a5568;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ± ë¹„ê±´ ë¼ì´í”„ íë ˆì´í„°</h1>
        <p class="subtitle">Vegan Life Curator - System Architecture</p>

        <div class="diagram-container">
            <div class="mermaid">
graph LR
    subgraph Client["<b>Client Layer</b>"]
        User[ğŸ‘¤ User]
        MainPage[MainPage]
        ScanPage[VeganScanPage]
        ChatPage[ChatbotPage]
        RecipePage[RecipePage]
    end

    subgraph Backend["<b>Backend / Orchestration Layer</b>"]
        Gateway[API Gateway<br/>FastAPI]
        
        subgraph Orchestrator["AgentOrchestrator<br/>(Brain of System)"]
            Master[Master Agent]
            VeganAgent[VeganScan<br/>Agent]
            ChatAgent[Chatbot<br/>Agent]
            RecipeAgent[Recipe<br/>Agent]
            ProfileAgent[Profile<br/>Agent]
            NutriAgent[Nutrition<br/>Agent]
        end
        
        LLM[LLM Generator<br/>GPT-4/Claude]
        Vision[Vision API<br/>GPT-4V/Google]
    end

    subgraph External["<b>External Services & Data</b>"]
        Weather[Weather API]
        Shopping[Shopping Sites]
        WebSearch[WebSearch Agent]
        
        subgraph DataLayer["<b>Data Layer</b>"]
            SQL[(SQL DB<br/>Users/Products<br/>Recipes/History)]
            Vector[(Vector DB<br/>Embeddings<br/>RAG System)]
        end
    end

    User -->|navigate| MainPage
    MainPage --> ScanPage
    MainPage --> ChatPage
    MainPage --> RecipePage
    
    ScanPage -->|POST /scan| Gateway
    ChatPage -->|POST /chat| Gateway
    RecipePage -->|GET /recipes| Gateway
    
    Gateway -->|route request| Master
    
    Master -->|delegate| VeganAgent
    Master -->|delegate| ChatAgent
    Master -->|delegate| RecipeAgent
    Master -->|delegate| ProfileAgent
    Master -->|delegate| NutriAgent
    
    VeganAgent <-->|analyze image| Vision
    ChatAgent <-->|generate response| LLM
    RecipeAgent <-->|get recipes| LLM
    RecipeAgent <-->|weather data| Weather
    NutriAgent <-->|nutrition calc| LLM
    
    VeganAgent -->|search products| WebSearch
    WebSearch <-->|query| Shopping
    
    Master -->|save/load| SQL
    Master -->|vector search| Vector
    
    VeganAgent -->|save scan| SQL
    ChatAgent -->|save chat| SQL
    RecipeAgent -->|query recipes| Vector
    ProfileAgent <-->|user data| SQL

    style Client fill:#e8e8e8
    style Backend fill:#f5f5f5
    style External fill:#e8e8e8
    style Orchestrator fill:#fff,stroke:#333,stroke-width:3px
    style DataLayer fill:#f0f0f0
    style Master fill:#667eea,color:#fff
            </div>
        </div>

        <!-- ë‹¤ì´ì–´ê·¸ë¨ ì„¤ëª… -->
        <div class="info-section">
            <div class="info-title">ğŸ“‹ ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ</div>
            <div class="info-grid">
                <div class="info-card">
                    <div class="card-title">ğŸ–¥ï¸ Client Layer</div>
                    <div class="card-content">
                        â€¢ Django Templates ê¸°ë°˜ UI<br>
                        â€¢ ë©”ì¸í˜ì´ì§€, ìŠ¤ìº”, ì±—ë´‡, ë ˆì‹œí”¼ í˜ì´ì§€<br>
                        â€¢ RESTful API í˜¸ì¶œ<br>
                        â€¢ ë°˜ì‘í˜• ë””ìì¸
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">ğŸ¤– Backend Layer</div>
                    <div class="card-content">
                        â€¢ FastAPI Gateway<br>
                        â€¢ Multi-Agent Orchestrator<br>
                        â€¢ 6ê°œ ì „ë¬¸ ì—ì´ì „íŠ¸<br>
                        â€¢ LLM/Vision API í†µí•©
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">ğŸŒ External Services</div>
                    <div class="card-content">
                        â€¢ Weather API (ë‚ ì”¨ ê¸°ë°˜ ì¶”ì²œ)<br>
                        â€¢ Shopping Sites (ê°€ê²© ë¹„êµ)<br>
                        â€¢ GPT-4, Claude API<br>
                        â€¢ Google Vision API
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">ğŸ—„ï¸ Data Layer</div>
                    <div class="card-content">
                        â€¢ PostgreSQL (ê´€ê³„í˜• ë°ì´í„°)<br>
                        â€¢ Vector DB (ì„ë² ë”©)<br>
                        â€¢ RAG System (ê²€ìƒ‰ ì¦ê°•)<br>
                        â€¢ Redis Cache
                    </div>
                </div>
            </div>
        </div>

        <!-- Agent ì—­í•  ì„¤ëª… -->
        <div class="info-section">
            <div class="info-title">ğŸ¯ Agent ì—­í• </div>
            <div class="info-grid">
                <div class="info-card">
                    <div class="card-title">ğŸ§  Master Agent</div>
                    <div class="card-content">
                        ì „ì²´ ì‹œìŠ¤í…œ ì¡°ìœ¨ ë° ì˜ì‚¬ê²°ì •<br>
                        ìš”ì²­ ë¶„ì„ â†’ ì—ì´ì „íŠ¸ ì„ íƒ â†’ ê²°ê³¼ í†µí•©
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">ğŸ” VeganScan Agent</div>
                    <div class="card-content">
                        ì œí’ˆ ì´ë¯¸ì§€ ë¶„ì„ â†’ ì„±ë¶„ ì¶”ì¶œ (OCR)<br>
                        ë¹„ê±´ ì—¬ë¶€ íŒì • â†’ ëŒ€ì•ˆ ì œí’ˆ ì¶”ì²œ
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">ğŸ’¬ Chatbot Agent</div>
                    <div class="card-content">
                        ìì—°ì–´ ëŒ€í™” ì²˜ë¦¬<br>
                        ë§ì¶¤ ìƒë‹´ ë° ì¶”ì²œ ì œê³µ
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">ğŸ³ Recipe Agent</div>
                    <div class="card-content">
                        ë‚ ì”¨/TPO ê¸°ë°˜ ë ˆì‹œí”¼ ê²€ìƒ‰<br>
                        ì˜ì–‘ ê· í˜• ê³ ë ¤ ì¶”ì²œ
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">ğŸ‘¤ Profile Agent</div>
                    <div class="card-content">
                        ì‚¬ìš©ì í”„ë¡œí•„ ê´€ë¦¬<br>
                        ê±´ê°•ì •ë³´, ì„ í˜¸ë„ ì €ì¥
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">ğŸ“Š Nutrition Agent</div>
                    <div class="card-content">
                        ì˜ì–‘ ì„±ë¶„ ë¶„ì„<br>
                        ê±´ê°• ìƒíƒœ ê¸°ë°˜ í‰ê°€
                    </div>
                </div>
            </div>
        </div>

        <!-- ë°ì´í„° íë¦„ -->
        <div class="info-section">
            <div class="info-title">ğŸ”„ ì£¼ìš” ë°ì´í„° íë¦„</div>
            <div class="info-grid">
                <div class="info-card">
                    <div class="card-title">1ï¸âƒ£ ì œí’ˆ ìŠ¤ìº” í”Œë¡œìš°</div>
                    <div class="card-content">
                        ì‚¬ìš©ì â†’ ì´ë¯¸ì§€ ì—…ë¡œë“œ â†’ API Gateway<br>
                        â†’ VeganScan Agent â†’ Vision API (OCR)<br>
                        â†’ ì„±ë¶„ ë¶„ì„ â†’ DB ì¡°íšŒ â†’ ê²°ê³¼ ë°˜í™˜
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">2ï¸âƒ£ ì±—ë´‡ ìƒë‹´ í”Œë¡œìš°</div>
                    <div class="card-content">
                        ì‚¬ìš©ì ì§ˆë¬¸ â†’ API Gateway<br>
                        â†’ Chatbot Agent â†’ LLM (GPT-4/Claude)<br>
                        â†’ RAG Vector Search â†’ ì‘ë‹µ ìƒì„±
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">3ï¸âƒ£ ë ˆì‹œí”¼ ì¶”ì²œ í”Œë¡œìš°</div>
                    <div class="card-content">
                        ì‚¬ìš©ì ì¡°ê±´ â†’ Recipe Agent<br>
                        â†’ Weather API + Profile ì¡°íšŒ<br>
                        â†’ Vector DB ê²€ìƒ‰ â†’ ë§ì¶¤ ë ˆì‹œí”¼ ì¶”ì²œ
                    </div>
                </div>
            </div>
        </div>

        <!-- ê¸°ìˆ  ìŠ¤íƒ -->
        <div class="info-section">
            <div class="info-title">ğŸ› ï¸ Technology Stack</div>
            <div class="info-grid">
                <div class="info-card">
                    <div class="card-title">Frontend</div>
                    <div class="card-content">
                        Django Templates<br>
                        HTML5, CSS3, JavaScript<br>
                        Bootstrap 5
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">Backend</div>
                    <div class="card-content">
                        FastAPI (API Gateway)<br>
                        Django (Web Framework)<br>
                        Uvicorn (ASGI Server)<br>
                        SQLAlchemy (ORM)
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">AI/ML</div>
                    <div class="card-content">
                        GPT-4, Claude API<br>
                        LangChain, LangGraph<br>
                        GPT-4 Vision API<br>
                        Google Vision API
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">Database</div>
                    <div class="card-content">
                        PostgreSQL (Main DB)<br>
                        FAISS / ChromaDB (Vector)<br>
                        Redis (Cache)<br>
                        S3 (File Storage)
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">DevOps</div>
                    <div class="card-content">
                        Docker, Docker Compose<br>
                        GitHub Actions (CI/CD)<br>
                        AWS / GCP<br>
                        Nginx (Reverse Proxy)
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-title">Monitoring</div>
                    <div class="card-content">
                        Prometheus<br>
                        Grafana<br>
                        Sentry (Error Tracking)<br>
                        CloudWatch
                    </div>
                </div>
            </div>
        </div>

        <!-- Legend -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-box" style="background: #e8e8e8;"></div>
                <div class="legend-text">Layer Group</div>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #667eea;"></div>
                <div class="legend-text">Master Agent</div>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #fff;"></div>
                <div class="legend-text">Components</div>
            </div>
            <div class="legend-item">
                <div style="width: 30px; height: 2px; background: #333; border-radius: 0;"></div>
                <div class="legend-text">Data Flow</div>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                padding: 20
            }
        });
    </script>
</body>
</html>